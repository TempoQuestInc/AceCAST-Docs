.. _howtouselink:

How to Use
===========

(Under Construction)

Running AceCAST
---------------

* Runtime Environment:
	* Ensure you have properly installed the required dependencies (see :ref:`installation <installationlink>` for more information) and have set up the corresponding runtime environment correctly. This can be done by sourcing the environment setup script generated by the installation script::

		$ source ~/tqi-build/env.sh

Namelist Considerations
-----------------------

* AceCAST uses the same namelist options that are used by WRF with the exception that certain options are not yet supported. We have provided a summary of the most relevant supported packages :ref:`here <toolslink>` as well as in the README.namelist_support file. We have provided the "AceCAST Advisor" utility (run/acecast-advisor.sh) to help users modify their namelist to one that is supported by AceCAST (see previous link for more details).
* In addition, the acecast.exe executable performs a check for supported options at runtime and will terminate execution if an unsupported option is selected in the namelist (see the previous link for more details).

MPI Usage
---------

* AceCAST uses MPI for running on multiple GPUs just as CPU WRF does for running on multiple CPU cores. The recommended strategy is to launch one MPI rank per GPU. This is typically done using the gpu-launch.sh mpi wrapper script, which properly assigns a GPU to each rank using its rank number. Here are a couple of examples:
		
.. include:: _templates/mpi_table.txt

Scaling Considerations
----------------------

* Although GPUs typically offer far more performance potential than typical CPUs, they do require relatively large parallel workloads to efficiently utilize the thousands of CUDA execution cores available to each GPU. This means that it is not very efficient to use more GPUs than is necessary for a given domain's grid size. To assist AceCAST users we have provided the "AceCAST Advisor" utility (run/acecast-advisor.sh), which, in addition to assisting with namelist selection, will determine a good number of GPUs to use based on the given namelist and user's GPU compute architecture (See :ref:`tools <toolslink>` for more).



.. admonition:: A Note on Preprocessing
   
   The role of AceCAST is simply to accelerate the execution of WRF itself on GPUs. This does not include any other elements of a typical workflow such as the components of WPS or real.exe. These should be run as one would for CPU-WRF to generate the inputs for AceCAST (i.e. wrfinput*, wrfbdy*, etc.). For your convenience we have provided a real.exe binary for host-side execution..



